---
title: 'Drake Data: 9/25/21'
author: "Ben VanderWall"
date: "9/21/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

```{r}
data <- readxl::read_excel("Data/Drake DF.xlsx")
data <- data %>% filter(row_number() <= n()-1)

df <- form_sum("Goals")
df2 <- form_sum("Shots")
df3 <- form_sum("Shots on Target")
df4 <- form_sum("Chances")
df5 <- form_sum("Key Passes")
df6 <- form_sum("Key Passes Accurate")
df7 <- form_sum("Crosses")


df4 <- form_sum("Fouls")


df <- form_mean("Goals")
df2 <- form_mean("Chances")
```

```{r}
form_mean <- function(col) {
  vec <- pull(data, col)
  vec <- gsub("-", "0", vec)
  vec <- as.numeric(vec)
  df <- data.frame(mean(vec[1:3]), mean(vec[1:5]), mean(vec))
  colnames(df) <- (c("Last 3", "Last 5", "Season"))
  rownames(df) <- (col)
  df
}

form_sum <- function(col) {
  vec <- pull(data, col)
  vec <- gsub("-", "0", vec)
  vec <- as.numeric(vec)
  df <- data.frame(sum(vec[1:3]), sum(vec[1:5]), sum(vec))
  colnames(df) <- (c("Last 3", "Last 5", "Season"))
  rownames(df) <- (col)
  df
}
```

